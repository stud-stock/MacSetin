1. Собрать топологию по рисунку Lab_13_1.png

2. Присвоить интерфейсам адреса, указанные на рисунке.

3. В публичной области сети настроить между AR1-AR2-AR3 OSPF маршрутизацию.
- Частные сети 192.N.х.0/24 в процесс OSPF не включать.

4. Убедиться в успешном прохождении пакетов между AR1-AR2-AR3.

5. СОХРАНИТЬ ТОПОЛОГИЮ ДЛЯ ДАЛЬНЕЙШЕГО ИСПОЛЬЗОВАНИЯ (1).

6. Настроить GRE-туннень на AR1:
- создание туннельного интерфейса:
[Huawei]interface Tunnel 0/0/0

- настрока типа туннеля
[Huawei-Tunnel0/0/0]tunnel-protocol gre 

- настройка локального конца туннеля:
[Huawei-Tunnel0/0/0]source GigabitEthernet 0/0/1

=> возможный вариант задания начала туннеля - указание адреса исходящего интерфейса:
[Huawei-Tunnel0/0/0]source 20.0.N.1

- настройка точки выхода их туннеля:
[Huawei-Tunnel0/0/0]destination 20.0.N.6

- назначение адреса локальному концу теннеля:
[Huawei-Tunnel0/0/0]ip address 192.N.3.1 30

- обратить внимание - туннель стал активен после назначения адреса, 
правильная настройка на противоположной стороне не потребовалась
(хотя, конечно, без настройки противоположной стороны туннель не работает)

7. Убедиться, что:
- туннель "включился" (display ip interface brief)
- в таблице маршрутизации появилась запись для сети 192.N.3.0/30

8. Аналогичным образом настроить туннель на AR3 (для назначения адреса использовать 
ту же сеть, оставшийся адрес)

9. С AR3 выполнить трассировку AR1 по адресам 20.0.N.1 и 192.N.3.1
- в чем различие результатов?

- обратить внимание - трассировка по адресу 192.N.3.1 работает, но на AR2 в 
таблице маршрутизации этой сети (192.N.3.0/30) нет.

10. Выполнить перехват icmp пакетов, направленных с АR1 на адрес 192.N.3.2
- сколько IP заголовков и с какими адресами содержится в перехваченных пакетах?

11. На AR1, AR3, AR4 настроить OSPF маршрутизацию ТОЛЬКО для сетей 192.N.х.0/24 
(т.е. только для частных сетей, входящих в состав LAN-1 и LAN-2). На AR1 и AR3,
таким образом, будет по 2 процесса.

12. Убедиться, что:
- На AR1, AR3, AR4 присутствуют все "частные" сети.
- На AR1, AR3, AR4 для "частных" не присоединенных сетей источник муршрутной информации - OSPF
- На AR4, внутреннем маршрутизаторе LAN-2 в таблице маршрутизации нет "публичных" сетей
- На AR2, транзитном "публичном" маршрутизаторе в таблице маршрутизации нет "частных" сетей
- С РС1 пингуется РС2.

СОХРАНИТЬ ТОПОЛОГИЮ ДЛЯ ДАЛЬНЕЙШЕГО ИСПОЛЬЗОВАНИЯ (2)

13. Выполнить просмотр таблицы маршрутизации на AR1 или AR3, AR4 (где есть LAN-сети)
- какая метрика у сетей, доступных через туннель?

- выполнить просмотр состояния туннельного интерфейса:
display ospf 2 interface tunnel0/0/0

- какае значение cost у туннеля?
- задать вес маршрута на туннельном интерфейсе (на AR1 и AR3):
[Huawei-Tunnel0/0/0]ospf cost 10

- повторить просмотр метрик маршрутов

14. Выполнить трассировку с РС1 до РС2
- сколько хопов в маршруте?
- присутствует ли в числе промежуточных узлов АR2?
- почему?

15. Выполнить трассировку с РС1 до AR3 по разным адресам (20.0.N.6 и 192.N.1.1)
- сколько хопов в маршрутах?
- почему во втором случае на 1 хоп меньше?
- почему в первом случае адрес 2го хопа не определен?
- какова инкапсуляция пакетов в этих случаях?

16. С помощью Wireshark перехватить OSPF-пакет,используемый тем OSPF процессом,
 который используется для организации маршрутизации трафика частных сетей, на участке между AR2 и AR3.
- Убедиться, что в кадре присутствуют 2 IP заголовка - с публичными и частными адресами.
- Трафик шифрован?

17. На AR2 создать ACL, запрещающий прохождение ICMP трафика 

18. Назначить этот ACL интерфейсу Gi0/0/0 в направлении "inbound".

19. Выполнить:
- команду рing с РС1 на РС2 (ping 192.N.2.2)
- команду рing с R1 на R3 (ping 20.0.N.6)

- каков результат?
- почему ACL работает именно так?

20. На AR4 создать ACL, запрещающий прохождение ICMP трафика

21. Назначить этот ACL интерфейсу Gi0/0/1 в направлении "outbound".
- Убедиться, что ACL задан верно и icmp пакеты с РС1 до РС2 (192.N.2.10) не проходят.

